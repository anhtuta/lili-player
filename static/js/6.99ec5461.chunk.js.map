{"version":3,"sources":["components/Toast/Toast.js","components/Auth/Auth.js","service/axiosClient.js","components/Nav/Nav.js"],"names":["options","position","toast","POSITION","TOP_RIGHT","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","progress","undefined","customToast","info","text","success","warn","error","err","msg","data","message","toString","auth","constructor","isAuthenticated","localStorage","getItem","ACCESS_TOKEN","login","_ref","successCallback","failCallback","username","password","axiosClient","post","then","res","setItem","catch","logout","removeItem","window","location","console","log","Toast","getMe","get","redirectToLoginPage","hash","rolesHasPermission","roles","path","ROLE_TABLE","i","length","includes","this","userInfo","axios","interceptors","request","use","config","newConfig","paramsSerializer","params","queryString","stringify","obj","Object","keys","forEach","k","arrayFormat","baseURL","process","headers","Pragma","Authorization","Promise","reject","response","status","Nav","Component","arguments","handleLogout","getActiveMenuItems","roleArray","menuItems","item","index","subItems","enabled","generateMenu","pathname","props","map","itemClass","React","createElement","key","className","level","Link","to","name","toggleDarkMode","theme","updateTheme","context","THEME_LIGHT","THEME_DARK","render","MENU_ITEMS","title","onClick","role","aria-label","contextType","LiliContext","withRouter"],"mappings":"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","file":"static/js/6.99ec5461.chunk.js","sourcesContent":["import { toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.min.css';\n\nconst options = {\n  position: toast.POSITION.TOP_RIGHT, //\"top-right\"\n  autoClose: 3000,\n  hideProgressBar: false,\n  closeOnClick: true,\n  pauseOnHover: true,\n  draggable: true,\n  progress: undefined\n};\n\nconst info = (text) => {\n  toast.info(text, options);\n};\n\nconst success = (text) => {\n  toast.success(text, options);\n};\n\nconst warn = (text) => {\n  toast.warn(text, options);\n};\n\nconst error = (err) => {\n  let msg;\n  if (err.data && err.data.message) msg = err.data.message;\n  else if (err) msg = err.toString();\n  else msg = 'Error: unexpected error occurred!';\n  toast.error(msg, options);\n};\n\nconst customToast = {\n  info,\n  success,\n  warn,\n  error\n};\n\nexport default customToast;\n","import { ACCESS_TOKEN } from '../../constants/Constants';\nimport axiosClient from '../../service/axiosClient';\nimport Toast from '../Toast/Toast';\nimport { ROLE_TABLE } from '../../constants/Constants';\n\nclass Auth {\n  constructor() {\n    this.userInfo = null;\n  }\n\n  isAuthenticated = () => {\n    const access_token = localStorage.getItem(ACCESS_TOKEN);\n    return !!access_token;\n  };\n\n  login = ({ username, password }, successCallback, failCallback) => {\n    const data = {\n      username,\n      password\n    };\n    axiosClient\n      .post('/signin', data)\n      .then((res) => {\n        localStorage.setItem(ACCESS_TOKEN, res[ACCESS_TOKEN]);\n        successCallback();\n      })\n      .catch((err) => {\n        failCallback(err.data ? err.data : err);\n      });\n  };\n\n  logout = () => {\n    axiosClient\n      .post('/signout')\n      .then((res) => {\n        localStorage.removeItem(ACCESS_TOKEN);\n        window.location = '/';\n      })\n      .catch((err) => {\n        console.log(err);\n        Toast.error(err);\n      });\n  };\n\n  getMe = () => {\n    return axiosClient.get('/api/user/me');\n  };\n\n  redirectToLoginPage = () => {\n    Toast.info('You need to login first!');\n    localStorage.removeItem(ACCESS_TOKEN);\n    window.location.hash = '/login';\n  };\n\n  /**\n   * Check xem mảng roles có tồn tại role nào có quyền truy cập path hay ko\n   * @param {string[]} roles - Array of role\n   * @param {string} path - URL\n   */\n  rolesHasPermission = (roles, path) => {\n    if (!ROLE_TABLE[path]) return true;\n    for (let i = 0; i < roles.length; i++) {\n      if (ROLE_TABLE[path].includes(roles[i])) return true;\n    }\n    // Dùng forEach: bất đồng bộ nên ko được nhé!\n    // Nó sẽ return false trước khi chạy vào trong forEach\n    // roles.forEach(role => {\n    //   if (ROLE_TABLE[path].includes(role)) return true;\n    // });\n    return false;\n  };\n}\n\nexport let auth = new Auth();\n","import axios from 'axios';\nimport queryString from 'query-string';\nimport { ACCESS_TOKEN } from '../constants/Constants';\nimport { auth } from '../components/Auth/Auth';\n\nconst cleanParam = (obj) => {\n  Object.keys(obj).forEach((k) => {\n    if (obj[k] === null || obj[k] === undefined) {\n      delete obj[k];\n    }\n  });\n  return obj;\n};\n\naxios.interceptors.request.use(\n  function (config) {\n    const newConfig = {\n      ...config,\n      paramsSerializer: (params) =>\n        queryString.stringify(cleanParam(params), { arrayFormat: 'repeat' }),\n      baseURL: process.env.REACT_APP_HOST_API,\n      // withCredentials: true,\n      headers: {\n        ...config.headers,\n        Pragma: 'no-cache'\n      }\n    };\n\n    // Add auth token\n    if (localStorage.getItem(ACCESS_TOKEN)) {\n      newConfig.headers.Authorization = `Bearer ${localStorage.getItem(ACCESS_TOKEN)}`;\n    }\n\n    return newConfig;\n  },\n  (error) => {\n    console.log(error);\n    return Promise.reject(error);\n  }\n);\n\naxios.interceptors.response.use(\n  (response) => {\n    if (response && response.data) return response.data;\n    return response;\n  },\n  (error) => {\n    if (error.response && error.response.status) {\n      if (error.response.status === 401) {\n        auth.redirectToLoginPage();\n      }\n      //... handle other statuses\n      return Promise.reject(error.response);\n    } else {\n      return Promise.reject(error);\n    }\n  }\n);\n\nexport default axios;\n","import React, { Component } from 'react';\nimport { Link, withRouter } from 'react-router-dom';\nimport { MENU_ITEMS, THEME_DARK, THEME_LIGHT } from '../../constants/Constants';\nimport { auth } from '../Auth/Auth';\nimport { LiliContext } from '../../context/LiliContext';\nimport './Nav.scss';\n\nclass Nav extends Component {\n  // contextType là 1 biến của React.Component,\n  // sau lệnh gán này ta có thể dùng được data của LiliContext thông qua: this.context\n  static contextType = LiliContext;\n\n  handleLogout = () => {\n    auth.logout();\n  };\n\n  getActiveMenuItems = (roleArray, menuItems) => {\n    menuItems.forEach((item, index) => {\n      if (item.subItems) {\n        this.getActiveMenuItems(roleArray, item.subItems);\n      } else {\n        if (!auth.rolesHasPermission(roleArray, item.path)) {\n          // ĐỪNG dùng splice, bởi vì JS bất đồng bộ nên sẽ bị lỗi thỉnh thoảng bị miss menu item\n          // menuItems.splice(index, 1);\n          item.enabled = false;\n        }\n      }\n    });\n  };\n\n  generateMenu = (menuItems) => {\n    const { pathname } = this.props.location;\n    return menuItems.map((item) => {\n      const itemClass = 'menu-item' + (item.path === pathname ? ' active-menu' : '');\n      if (item.path === null) item.path = '#';\n\n      if (item.subItems) {\n        return (\n          <li key={item.key} className={itemClass + ' menu-parent level' + item.level}>\n            <Link to={item.path}>\n              {item.name} <i className={'caret fas ' + (item.level > 1 ? 'fa-caret-right' : 'fa-caret-down')}></i>\n            </Link>\n            <ul key={item.key} className={itemClass + ' sub-menu level' + (item.level + 1)}>\n              {this.generateMenu(item.subItems)}\n            </ul>\n          </li>\n        );\n      } else {\n        return (\n          item.enabled && (\n            <li key={item.key} className={itemClass + ' level' + item.level}>\n              <Link to={item.path}>{item.name}</Link>\n            </li>\n          )\n        );\n      }\n    });\n  };\n\n  toggleDarkMode = () => {\n    const { theme, updateTheme } = this.context;\n    if (theme === THEME_LIGHT) {\n      updateTheme(THEME_DARK);\n    } else {\n      updateTheme(THEME_LIGHT);\n    }\n  };\n\n  render() {\n    const { userInfo } = this.props;\n    const roleArray = userInfo ? userInfo.roleArray : [];\n    const menuItems = [...MENU_ITEMS];\n    const { theme } = this.context;\n    this.getActiveMenuItems(roleArray, menuItems);\n\n    return (\n      <nav className=\"custom-navbar\">\n        <ul className=\"nav-wrapper\">{this.generateMenu(menuItems)}</ul>\n        <div className=\"userinfo-wrapper\">\n          <div className=\"div-header\">\n            <span\n              className=\"btn_dark_mode\"\n              title={theme === THEME_LIGHT ? 'Toggle Dark mode' : 'Toggle Light mode'}\n              onClick={this.toggleDarkMode}\n              role=\"img\"\n              aria-label=\"emoji\"\n            >\n              {theme === THEME_LIGHT ? '🌜' : '🌞'}\n            </span>\n          </div>\n        </div>\n      </nav>\n    );\n  }\n}\n\n// Use withRouter HOC in order to inject match, history and location in your component props.\nexport default withRouter(Nav);\n"],"sourceRoot":""}